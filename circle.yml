machine:
  java:
    version: oraclejdk8

general:
  artifacts:
    - "redspark-initializr-service/target/redspark-initializr-service.jar"

test:
  override:
    - mvn --fail-never dependency:go-offline -f pom.xml || true
    - mvn install jacoco:report coveralls:report -DrepoToken=1nqr7w1iwtzAToi58EabiIhjhMgeoZoNR

  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/target/surefire-reports/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;

deployment:
  master:
    branch: deploy
    commands:
        - ./deploy.sh
